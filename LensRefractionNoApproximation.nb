(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.1' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     92537,       2085]
NotebookOptionsPosition[     90063,       2032]
NotebookOutlinePosition[     90418,       2048]
CellTagsIndexPosition[     90375,       2045]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[TextData[StyleBox["Refraction through a lens  (no approximations)",
 FontColor->GrayLevel[0]]], "Title",
 CellChangeTimes->{{3.7618375295181704`*^9, 
  3.7618375755366917`*^9}},ExpressionUUID->"1558d90f-ff46-45d0-9a19-\
705206b84cfc"],

Cell["\<\
The two surface of the lens are takes to be circles. This can be changes so \
that the two bounding surface are any smooth curves. \
\>", "Text",
 CellChangeTimes->{{3.761837594840364*^9, 
  3.7618376271879787`*^9}},ExpressionUUID->"3a51ea9d-8b2f-44b9-92c1-\
1491937d33e5"],

Cell[CellGroupData[{

Cell["Notation", "Subsection",
 CellGroupingRules->{"GroupTogetherGrouping", 10001.},
 CellChangeTimes->{{3.7618376377828197`*^9, 
  3.761837643803133*^9}},ExpressionUUID->"94f4e1c6-b805-4e8c-96b7-\
bfda568c21df"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"<<", "Notation`"}], "\[IndentingNewLine]", 
   RowBox[{"Symbolize", "[", 
    TemplateBox[{SubscriptBox["x_", "y_"]},
     "NotationTemplateTag"], "]"}], "\[IndentingNewLine]", 
   RowBox[{"Symbolize", "[", 
    TemplateBox[{UnderscriptBox["x_", "_"]},
     "NotationTemplateTag"], "]"}], "\[IndentingNewLine]", 
   RowBox[{"Notation", "[", 
    RowBox[{
     TemplateBox[{RowBox[{"x_", "\[CircleTimes]", "y_"}]},
      "NotationTemplateTag"], " ", "\[DoubleLongLeftRightArrow]", " ", 
     TemplateBox[{RowBox[{"DyadicProduct", "[", 
         RowBox[{"x_", ",", "y_"}], "]"}]},
      "NotationTemplateTag"]}], "]"}]}]}]], "Input",
 CellGroupingRules->{"GroupTogetherGrouping", 10001.},
 CellChangeTimes->{{3.7617403202834053`*^9, 3.761740343631139*^9}, 
   3.7617461775203123`*^9, {3.761747010066691*^9, 3.7617470308240957`*^9}, {
   3.7617487392005463`*^9, 3.761748758284412*^9}, {3.761788817271844*^9, 
   3.76178881804401*^9}, {3.761826430781653*^9, 3.761826439788383*^9}, {
   3.761827636112319*^9, 3.761827647153418*^9}, {3.761827682585907*^9, 
   3.761827707736788*^9}, {3.761832635388815*^9, 3.761832636391609*^9}, 
   3.761837643806196*^9},ExpressionUUID->"dd9b7a16-d3bf-486f-a1d5-\
a7b371677baf"]
}, Closed]],

Cell[CellGroupData[{

Cell["Subroutines", "Subsection",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.},
 CellChangeTimes->{{3.76183712662411*^9, 
  3.761837134931328*^9}},ExpressionUUID->"a24b34c4-1026-4560-a854-\
0a7a9d6d6c3a"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"ClearAll", "[", "\"\<Global`*\>\"", "]"}], "\[IndentingNewLine]", 
   
   RowBox[{
    RowBox[{
     UnderscriptBox[
      UnderscriptBox["\[CapitalIota]", "_"], "_"], "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"DyadicProduct", "[", 
     RowBox[{"x_", ",", "y_"}], "]"}], ":=", "\[IndentingNewLine]", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"n", "=", 
        RowBox[{"Length", "[", "x", "]"}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"x", "[", 
          RowBox[{"[", "i", "]"}], "]"}], 
         RowBox[{"y", "[", 
          RowBox[{"[", "j", "]"}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "n"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "1", ",", "n"}], "}"}]}], "]"}]}], "]"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"s1", "[", "x_", "]"}], ":=", 
    RowBox[{"s1", "[", 
     RowBox[{"Unevaluated", "[", "x", "]"}], "]"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"r1", "[", "x_", "]"}], ":=", 
    RowBox[{"r1", "[", 
     RowBox[{"Unevaluated", "[", "x", "]"}], "]"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"s2", "[", "x_", "]"}], ":=", 
    RowBox[{"s1", "[", 
     RowBox[{"Unevaluated", "[", "x", "]"}], "]"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"r2", "[", "x_", "]"}], ":=", 
    RowBox[{"r1", "[", 
     RowBox[{"Unevaluated", "[", "x", "]"}], "]"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"ClearAll", "[", 
    RowBox[{
    "DrawRay", ",", "yl", ",", "Intersect", ",", "DrawSurf", ",", 
     "Computemc"}], "]"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"yl", "[", 
      RowBox[{"x_", ",", "m_", ",", "c_"}], "]"}], ":=", " ", 
     RowBox[{
      RowBox[{"m", " ", "x"}], " ", "+", "c"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"DrawRay", "[", 
     RowBox[{
      RowBox[{"r_", "/;", 
       RowBox[{
        RowBox[{"r", "[", "\"\<type\>\"", "]"}], "\[Equal]", 
        "\"\<ray\>\""}]}], ",", 
      RowBox[{"color_:", "Red"}], ",", 
      RowBox[{"details_:", "\"\<False\>\""}]}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"data", ",", "p1", ",", "p2"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"p1", "=", 
        RowBox[{"r", "[", "\"\<pt1\>\"", "]"}]}], ";", "\[IndentingNewLine]", 
       
       RowBox[{"p2", "=", 
        RowBox[{"r", "[", "\"\<pt2\>\"", "]"}]}], ";", "\[IndentingNewLine]", 
       
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"details", "\[Equal]", "\"\<True\>\""}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Graphics", "[", 
          RowBox[{"{", 
           RowBox[{"color", ",", 
            RowBox[{"Arrow", "[", 
             RowBox[{"{", 
              RowBox[{"p1", ",", "p2"}], "}"}], "]"}]}], "}"}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Graphics", "[", 
          RowBox[{"{", 
           RowBox[{"color", ",", 
            RowBox[{"Line", "[", 
             RowBox[{"{", 
              RowBox[{"p1", ",", "p2"}], "}"}], "]"}]}], "}"}], "]"}]}], 
        "]"}]}]}], "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"DrawSurf", "[", 
     RowBox[{"s_", "/;", 
      RowBox[{
       RowBox[{"s", "[", "\"\<type\>\"", "]"}], "\[Equal]", "\"\<surface\>\""}
       ]}], "]"}], ":=", 
    RowBox[{"Module", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", "data", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"Graphics", "@", 
       RowBox[{"Circle", "[", 
        RowBox[{
         RowBox[{"s", "[", "\"\<origin\>\"", "]"}], ",", 
         RowBox[{"s", "[", "\"\<radius\>\"", "]"}]}], "]"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Ray", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"x1_:", "0.0"}], ",", 
        RowBox[{"y1_:", "0.0"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"x2_:", "0.0"}], ",", 
        RowBox[{"y2_:", "0.0"}]}], "}"}], ",", 
      RowBox[{"slope_:", "\"\<EMPTY\>\""}]}], "]"}], ":=", 
    "\[IndentingNewLine]", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"\[Theta]", ",", "r", ",", "m", ",", "c"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"slope", "\[Equal]", "\"\<EMPTY\>\""}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"r", "=", 
          RowBox[{"<|", 
           RowBox[{
            RowBox[{"\"\<pt1\>\"", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{"x1", ",", "y1"}], "}"}]}], ",", 
            RowBox[{"\"\<pt2\>\"", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{"x2", ",", "y2"}], "}"}]}], ",", " ", 
            RowBox[{"\"\<type\>\"", "\[Rule]", "\"\<ray\>\""}]}], "|>"}]}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"m", ",", "c"}], "}"}], "=", 
          RowBox[{"Computemc", "[", "r", "]"}]}], ";", "\[IndentingNewLine]", 
         
         RowBox[{
          RowBox[{"r", "[", "\"\<slope\>\"", "]"}], "=", "m"}], ";", 
         "\[IndentingNewLine]", "r"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"\[Theta]", "=", 
          RowBox[{
           RowBox[{"ArcTan", "[", "slope", "]"}], "//", "N"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"<|", 
          RowBox[{
           RowBox[{"\"\<pt1\>\"", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"x1", ",", "y1"}], "}"}]}], ",", 
           RowBox[{"\"\<pt2\>\"", "\[Rule]", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"x1", ",", "y1"}], "}"}], "+", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Cos", "[", "\[Theta]", "]"}], ",", 
               RowBox[{"Sin", "[", "\[Theta]", "]"}]}], "}"}]}]}], ",", 
           RowBox[{"\"\<slope\>\"", "\[Rule]", "slope"}], ",", " ", 
           RowBox[{"\"\<type\>\"", "\[Rule]", "\"\<ray\>\""}]}], "|>"}]}]}], 
       "\[IndentingNewLine]", "]"}]}], "]"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Computemc", "[", 
     RowBox[{"ry_", "/;", 
      RowBox[{
       RowBox[{"ry", "[", "\"\<type\>\"", "]"}], "\[Equal]", 
       "\"\<ray\>\""}]}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "sol", ",", "m", ",", "c", ",", "x1", ",", "y1", ",", "x2", ",", 
        "y2"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{"x1", ",", "y1"}], "}"}], "=", 
        RowBox[{"ry", "[", "\"\<pt1\>\"", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"x2", ",", "y2"}], "}"}], "=", 
        RowBox[{"ry", "[", "\"\<pt2\>\"", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"m", ",", "c"}], "}"}], "/.", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Solve", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"yl", "[", 
               RowBox[{"x1", ",", "m", ",", "c"}], "]"}], "\[Equal]", "y1"}], 
             " ", "&&", " ", 
             RowBox[{
              RowBox[{"yl", "[", 
               RowBox[{"x2", ",", "m", ",", "c"}], "]"}], "\[Equal]", 
              "y2"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"m", ",", "c"}], "}"}], ",", "Reals"}], "]"}], " ", "[", 
          
          RowBox[{"[", "1", "]"}], "]"}], ")"}]}]}]}], "\[IndentingNewLine]", 
     "]"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Intersect", "[", 
     RowBox[{
      RowBox[{"ry_", "/;", 
       RowBox[{
        RowBox[{"ry", "[", "\"\<type\>\"", "]"}], "\[Equal]", 
        "\"\<ray\>\""}]}], ",", " ", 
      RowBox[{"s_", "/;", " ", 
       RowBox[{
        RowBox[{"s", "[", "\"\<type\>\"", "]"}], "\[Equal]", 
        "\"\<surface\>\""}]}], ",", 
      RowBox[{"motion_:", "\"\<Entering\>\""}]}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "m", ",", "c", ",", "x1", ",", "y1", ",", "x2", ",", "y2", ",", "ox", 
        ",", "oy", ",", "r", ",", "x", ",", "y", ",", "sol"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{"ox", ",", "oy"}], "}"}], "=", 
        RowBox[{"s", "[", "\"\<origin\>\"", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"r", "=", 
        RowBox[{"s", "[", "\"\<radius\>\"", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"m", ",", "c"}], "}"}], "=", 
        RowBox[{"Computemc", "[", "ry", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"sol", "=", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"x", ",", "y"}], "}"}], "/.", 
         RowBox[{"NSolve", "[", " ", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"x", "-", "ox"}], ")"}], "2"], "+", " ", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"y", "-", "oy"}], ")"}], "2"]}], "\[Equal]", 
             SuperscriptBox["r", "2"]}], " ", "&&", " ", 
            RowBox[{
             RowBox[{"yl", "[", 
              RowBox[{"x", ",", "m", ",", "c"}], "]"}], "\[Equal]", "y"}]}], 
           ",", " ", 
           RowBox[{"{", 
            RowBox[{"x", ",", "y"}], "}"}]}], " ", "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"motion", "\[Equal]", "\"\<Entering\>\""}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"sol", "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "1"}], "]"}], "]"}], "<", 
            RowBox[{"sol", "[", 
             RowBox[{"[", 
              RowBox[{"2", ",", "1"}], "]"}], "]"}]}], ",", 
           RowBox[{"sol", "[", 
            RowBox[{"[", "1", "]"}], "]"}], ",", 
           RowBox[{"sol", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"sol", "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "1"}], "]"}], "]"}], ">", 
            RowBox[{"sol", "[", 
             RowBox[{"[", 
              RowBox[{"2", ",", "1"}], "]"}], "]"}]}], ",", 
           RowBox[{"sol", "[", 
            RowBox[{"[", "1", "]"}], "]"}], ",", 
           RowBox[{"sol", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], "\[IndentingNewLine]", 
        "]"}]}]}], "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"dir", "[", 
     RowBox[{"ry_", "/;", 
      RowBox[{
       RowBox[{"ry", "[", "\"\<type\>\"", "]"}], "\[Equal]", "\"\<ray\>\""}]}]
      , "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"pt1", ",", "pt2", ",", "d"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"pt1", "=", 
        RowBox[{"ry", "[", "\"\<pt1\>\"", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"pt2", "=", 
        RowBox[{"ry", "[", "\"\<pt2\>\"", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"d", "=", 
        RowBox[{"(", 
         RowBox[{"pt2", "-", "pt1"}], ")"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"d", "/", 
        RowBox[{"Norm", "[", "d", "]"}]}]}]}], "\[IndentingNewLine]", "]"}]}],
    "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"RefractDirection", "[", 
     RowBox[{
      RowBox[{
       UnderscriptBox["N", "_"], ":", "_"}], ",", 
      RowBox[{
       UnderscriptBox["s1", "_"], ":", "_"}], ",", 
      RowBox[{
       SubscriptBox["n", "1"], ":", "_"}], ",", 
      RowBox[{
       SubscriptBox["n", "2"], ":", "_"}]}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        UnderscriptBox[
         UnderscriptBox["P", "_"], "_"], ",", 
        RowBox[{"r", "=", 
         RowBox[{
          SubscriptBox["n", "1"], "/", 
          SubscriptBox["n", "2"]}]}]}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        UnderscriptBox[
         UnderscriptBox["P", "_"], "_"], "=", 
        RowBox[{"(", 
         RowBox[{
          UnderscriptBox["N", "_"], "\[CircleTimes]", 
          UnderscriptBox["N", "_"]}], " ", ")"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"r", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            UnderscriptBox[
             UnderscriptBox["\[CapitalIota]", "_"], "_"], "-", 
            UnderscriptBox[
             UnderscriptBox["P", "_"], "_"]}], ")"}], ".", 
          UnderscriptBox["s1", "_"]}]}], "-", 
        RowBox[{
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"1", "-", 
            RowBox[{
             SuperscriptBox["r", "2"], 
             RowBox[{"(", 
              RowBox[{"1", "-", 
               RowBox[{
                UnderscriptBox["s1", "_"], ".", 
                RowBox[{"(", 
                 RowBox[{
                  UnderscriptBox[
                   UnderscriptBox["P", "_"], "_"], ".", 
                  UnderscriptBox["s1", "_"]}], ")"}]}]}], ")"}]}]}], ")"}], 
          RowBox[{"1", "/", "2"}]], 
         UnderscriptBox["N", "_"]}]}]}]}], "]"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ComputeNormal", "[", 
     RowBox[{
      RowBox[{"s_", "/;", " ", 
       RowBox[{
        RowBox[{"s", "[", "\"\<type\>\"", "]"}], "\[Equal]", 
        "\"\<surface\>\""}]}], ",", "p_", ",", 
      RowBox[{"motion_:", "\"\<Entering\>\""}]}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"c", ",", "n"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"c", "=", 
        RowBox[{"s", "[", "\"\<origin\>\"", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"motion", "\[Equal]", "\"\<Entering\>\""}], ",", 
         RowBox[{"Normalize", "[", 
          RowBox[{"p", "-", "c"}], "]"}], ",", 
         RowBox[{"-", 
          RowBox[{"Normalize", "[", 
           RowBox[{"p", "-", "c"}], "]"}]}]}], "]"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"ClearAll", "[", "Refract", "]"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Refract", "[", 
     RowBox[{
      RowBox[{"ry_", "/;", 
       RowBox[{
        RowBox[{"ry", "[", "\"\<type\>\"", "]"}], "\[Equal]", 
        "\"\<ray\>\""}]}], ",", " ", 
      RowBox[{"s_", "/;", " ", 
       RowBox[{
        RowBox[{"s", "[", "\"\<type\>\"", "]"}], "\[Equal]", 
        "\"\<surface\>\""}]}], ",", 
      RowBox[{"motion_:", "\"\<Entering\>\""}]}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"p", ",", "n", ",", "ry1", ",", "ry2", ",", "d1", ",", 
        SubscriptBox["n", "1"], ",", 
        SubscriptBox["n", "2"]}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"motion", "\[Equal]", "\"\<Entering\>\""}], ",", 
         RowBox[{
          RowBox[{
           SubscriptBox["n", "1"], "=", "1"}], ";", 
          RowBox[{
           SubscriptBox["n", "2"], "=", 
           RowBox[{"s", "[", "\[Mu]", "]"}]}]}], ",", 
         RowBox[{
          RowBox[{
           SubscriptBox["n", "1"], "=", 
           RowBox[{"s", "[", "\[Mu]", "]"}]}], ";", 
          RowBox[{
           SubscriptBox["n", "2"], "=", "1"}]}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"p", "=", 
        RowBox[{"Intersect", "[", 
         RowBox[{"ry", ",", "s", ",", "motion"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"ry1", "=", 
        RowBox[{"Ray", "[", 
         RowBox[{
          RowBox[{"ry", "[", "\"\<pt1\>\"", "]"}], ",", "p"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"n", "=", 
        RowBox[{"ComputeNormal", "[", 
         RowBox[{"s", ",", "p", ",", "motion"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"ry2", "=", 
        RowBox[{"Ray", "[", 
         RowBox[{"p", ",", 
          RowBox[{"p", "+", 
           RowBox[{"RefractDirection", "[", 
            RowBox[{"n", ",", 
             RowBox[{"dir", "[", "ry1", "]"}], ",", 
             SubscriptBox["n", "1"], ",", 
             SubscriptBox["n", "2"]}], "]"}]}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"ry1", ",", "ry2", ",", "n", ",", "p"}], "}"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"ClearAll", "[", "PlotRays", "]"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"PlotRays", "[", 
     RowBox[{"r1_", ",", "r2_", ",", "s_", ",", "n_", ",", "p_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"Show", "[", 
       RowBox[{
        RowBox[{"Graphics", "@", 
         RowBox[{"Point", "[", "p", "]"}]}], ",", 
        RowBox[{"Graphics", "[", 
         RowBox[{"{", 
          RowBox[{"Dashed", ",", "Red", ",", 
           RowBox[{"Line", "[", 
            RowBox[{"{", 
             RowBox[{"p", ",", 
              RowBox[{"p", "+", 
               RowBox[{"dir", "[", "r1", "]"}]}]}], "}"}], "]"}]}], "}"}], 
         "]"}], ",", 
        RowBox[{"DrawRay", "[", 
         RowBox[{"r1", ",", "Red"}], "]"}], ",", 
        RowBox[{"DrawRay", "[", 
         RowBox[{"r2", ",", "Green"}], "]"}], ",", 
        RowBox[{"DrawSurf", "[", "s", "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"Graphics", "[", 
         RowBox[{"{", 
          RowBox[{"Gray", ",", 
           RowBox[{"Arrow", "[", 
            RowBox[{"{", 
             RowBox[{"p", ",", 
              RowBox[{"p", "+", "n"}]}], "}"}], "]"}]}], "}"}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Graphics", "[", 
         RowBox[{"{", 
          RowBox[{"Dashed", ",", "Gray", ",", 
           RowBox[{"Line", "[", 
            RowBox[{"{", 
             RowBox[{"p", ",", 
              RowBox[{"p", "-", "n"}]}], "}"}], "]"}]}], "}"}], "]"}]}], 
       "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"PlotRays2", "[", 
     RowBox[{"r1_", ",", "r2_", ",", "n_", ",", "p_", ",", 
      RowBox[{"details_:", "\"\<Flase\>\""}]}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"details", "\[Equal]", "\"\<True\>\""}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Show", "[", 
         RowBox[{
          RowBox[{"Graphics", "@", 
           RowBox[{"Point", "[", "p", "]"}]}], ",", 
          RowBox[{"Graphics", "[", 
           RowBox[{"{", 
            RowBox[{"Dashed", ",", "Red", ",", 
             RowBox[{"Line", "[", 
              RowBox[{"{", 
               RowBox[{"p", ",", 
                RowBox[{"p", "+", 
                 RowBox[{"dir", "[", "r1", "]"}]}]}], "}"}], "]"}]}], "}"}], 
           "]"}], ",", 
          RowBox[{"DrawRay", "[", 
           RowBox[{"r1", ",", "Red"}], "]"}], ",", 
          RowBox[{"DrawRay", "[", 
           RowBox[{"r2", ",", "Green"}], "]"}], ",", "\[IndentingNewLine]", 
          RowBox[{"Graphics", "[", 
           RowBox[{"{", 
            RowBox[{"Gray", ",", 
             RowBox[{"Arrow", "[", 
              RowBox[{"{", 
               RowBox[{"p", ",", 
                RowBox[{"p", "+", "n"}]}], "}"}], "]"}]}], "}"}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"Graphics", "[", 
           RowBox[{"{", 
            RowBox[{"Dashed", ",", "Gray", ",", 
             RowBox[{"Line", "[", 
              RowBox[{"{", 
               RowBox[{"p", ",", 
                RowBox[{"p", "-", "n"}]}], "}"}], "]"}]}], "}"}], "]"}]}], 
         "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"Show", "[", 
         RowBox[{
          RowBox[{"Graphics", "@", 
           RowBox[{"Point", "[", "p", "]"}]}], ",", 
          RowBox[{"DrawRay", "[", 
           RowBox[{"r1", ",", "Red", ",", "details"}], "]"}], ",", 
          RowBox[{"DrawRay", "[", 
           RowBox[{"r2", ",", "Green", ",", "details"}], "]"}]}], 
         "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}], 
     "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"PlotLens", "[", 
     RowBox[{"s1_", ",", "s2_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"Region", "@", 
       RowBox[{"RegionIntersection", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Disk", "[", 
          RowBox[{
           RowBox[{"s1", "[", "\"\<origin\>\"", "]"}], ",", 
           RowBox[{"s1", "[", "\"\<radius\>\"", "]"}]}], "]"}], ",", 
         "\[Continuation]", "\[IndentingNewLine]", 
         RowBox[{"Disk", "[", 
          RowBox[{
           RowBox[{"s2", "[", "\"\<origin\>\"", "]"}], ",", 
           RowBox[{"s2", "[", "\"\<radius\>\"", "]"}]}], "]"}]}], 
        "\[Continuation]", "\[IndentingNewLine]", "]"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ScaleRay", "[", 
     RowBox[{"ry_", ",", "\[Alpha]_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"pt1", ",", "pt2", ",", "l", ",", "d"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"pt1", "=", 
        RowBox[{"ry", "[", "\"\<pt1\>\"", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"pt2", "=", 
        RowBox[{"ry", "[", "\"\<pt2\>\"", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"l", "=", 
        RowBox[{"Norm", "[", 
         RowBox[{"pt1", "-", "pt2"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"d", "=", 
        RowBox[{"dir", "[", "ry", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"<|", 
        RowBox[{
         RowBox[{"\"\<pt1\>\"", "\[Rule]", "pt1"}], ",", 
         RowBox[{"\"\<pt2\>\"", "\[Rule]", 
          RowBox[{"pt1", "+", 
           RowBox[{"\[Alpha]", " ", "l", " ", "d"}]}]}], ",", " ", 
         RowBox[{"\"\<slope\>\"", "\[Rule]", 
          RowBox[{"ry", "[", "\"\<slope\>\"", "]"}]}], ",", 
         RowBox[{"\"\<type\>\"", "\[Rule]", "\"\<ray\>\""}]}], "|>"}]}]}], 
     "]"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"ClearAll", "[", "ShowPath", "]"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ShowPath", "[", 
     RowBox[{
      RowBox[{"x_:", "-", "10.0"}], ",", 
      RowBox[{"y_:", "0"}], ",", 
      RowBox[{"slope_:", "0.0"}], ",", "s1_", ",", "s2_", ",", 
      RowBox[{"\[Alpha]_:", "1"}], ",", 
      RowBox[{"details_:", "\"\<False\>\""}]}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "r1", ",", "r2", ",", "r3", ",", "n1", ",", "p1", ",", "n2", ",", "p2",
         ",", "plt1", ",", "plt2", ",", "rad1"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"rad1", "=", 
        RowBox[{"s1", "[", "\"\<radius\>\"", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"r1", "=", 
        RowBox[{"Ray", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"x", ",", "y"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "0"}], "}"}], ",", "slope"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"r1", ",", "r2", ",", "n1", ",", "p1"}], "}"}], "=", 
        RowBox[{"Refract", "[", 
         RowBox[{"r1", ",", "s1", ",", "\"\<Entering\>\""}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"plt1", "=", 
        RowBox[{"PlotRays2", "[", 
         RowBox[{"r1", ",", 
          RowBox[{"ScaleRay", "[", 
           RowBox[{"r2", ",", "\[Alpha]"}], "]"}], ",", "n1", ",", "p1", ",", 
          "details"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"r2", ",", "r3", ",", "n2", ",", "p2"}], "}"}], "=", 
        RowBox[{"Refract", "[", 
         RowBox[{"r2", ",", "s2", ",", "\"\<Leaving\>\""}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"plt2", "=", 
        RowBox[{"PlotRays2", "[", 
         RowBox[{"r2", ",", 
          RowBox[{"ScaleRay", "[", 
           RowBox[{"r3", ",", "\[Alpha]"}], "]"}], ",", "n2", ",", "p2", ",", 
          "details"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"plt1", ",", "plt2"}], "}"}]}]}], "\[IndentingNewLine]", 
     "]"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\[IndentingNewLine]"}]}]], "Input",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.},
 CellChangeTimes->{{3.761740427998501*^9, 3.761740433352602*^9}, {
   3.761740830254092*^9, 3.761740852873395*^9}, {3.761741261552601*^9, 
   3.761741309080043*^9}, {3.761741365382804*^9, 3.761741417228498*^9}, {
   3.761741613128399*^9, 3.76174163688619*^9}, {3.761742231340722*^9, 
   3.761742274956431*^9}, {3.761742306290946*^9, 3.761742319252921*^9}, {
   3.761742352449345*^9, 3.761742514362659*^9}, {3.761742648510206*^9, 
   3.761742653904104*^9}, {3.761742752780613*^9, 3.7617427804250927`*^9}, {
   3.7617430657931623`*^9, 3.7617430747830677`*^9}, {3.761743134263529*^9, 
   3.761743138083461*^9}, {3.761743236618301*^9, 3.761743265425609*^9}, {
   3.761743347545718*^9, 3.7617435725976477`*^9}, {3.761743627390592*^9, 
   3.761743690935042*^9}, {3.761743726506809*^9, 3.7617437378148623`*^9}, {
   3.761743780169588*^9, 3.76174384753926*^9}, {3.761744324959447*^9, 
   3.761744338615953*^9}, {3.761744388332432*^9, 3.761744394070878*^9}, {
   3.761744444504448*^9, 3.7617444478843718`*^9}, 3.761744625761003*^9, {
   3.761744715619722*^9, 3.761744752472474*^9}, {3.761744784558908*^9, 
   3.761744876791614*^9}, 3.761745055892685*^9, {3.761745158188472*^9, 
   3.761745244565414*^9}, {3.76174527736478*^9, 3.761745421461257*^9}, {
   3.761745491555406*^9, 3.761745513618482*^9}, {3.761745566249596*^9, 
   3.7617457372504063`*^9}, {3.761745792076168*^9, 3.761745823450323*^9}, {
   3.761746043152768*^9, 3.761746043305781*^9}, {3.761746086160887*^9, 
   3.76174615769674*^9}, {3.761746204163521*^9, 3.761746209271599*^9}, {
   3.76174630861025*^9, 3.761746456078883*^9}, {3.7617464907109747`*^9, 
   3.7617465274041443`*^9}, {3.7617466054060707`*^9, 3.761746629481433*^9}, {
   3.761746666472785*^9, 3.761746700321484*^9}, 3.761746739482703*^9, {
   3.761746811193965*^9, 3.761746818606718*^9}, {3.7617468736681833`*^9, 
   3.7617468757829943`*^9}, {3.761746911770204*^9, 3.761746911882739*^9}, {
   3.761746947788044*^9, 3.761747005842122*^9}, {3.7617470405223217`*^9, 
   3.761747062964281*^9}, 3.7617471063178463`*^9, {3.7617471649407454`*^9, 
   3.76174719063365*^9}, 3.761747366795795*^9, {3.7617476999111967`*^9, 
   3.761747724547821*^9}, {3.761747760527294*^9, 3.761747945313724*^9}, {
   3.7617480465650597`*^9, 3.761748052311798*^9}, {3.761748093832573*^9, 
   3.761748152353588*^9}, {3.761748194967533*^9, 3.761748251295061*^9}, {
   3.761748282145344*^9, 3.761748321753922*^9}, {3.7617489019728823`*^9, 
   3.761748914369894*^9}, {3.761749079664361*^9, 3.761749092746595*^9}, {
   3.761749132087777*^9, 3.761749137531551*^9}, {3.761749297166422*^9, 
   3.7617493578760567`*^9}, {3.761751279820208*^9, 3.761751302735371*^9}, 
   3.7617513423111753`*^9, 3.761751594103997*^9, {3.761751919835079*^9, 
   3.761751922189192*^9}, {3.7617521688707867`*^9, 3.7617521971709967`*^9}, 
   3.761752413783923*^9, {3.761752632415461*^9, 3.761752637910612*^9}, {
   3.761753032671067*^9, 3.761753167015839*^9}, {3.761753246828533*^9, 
   3.76175327052069*^9}, {3.761753303474462*^9, 3.761753326890336*^9}, {
   3.76175358397367*^9, 3.76175359018788*^9}, {3.7617538190968018`*^9, 
   3.7617539318910627`*^9}, {3.761754034386632*^9, 3.76175403728454*^9}, 
   3.761754766151239*^9, {3.761774498063231*^9, 3.761774515739717*^9}, {
   3.761774566652919*^9, 3.761774634289835*^9}, 3.7617747000389557`*^9, {
   3.761774800006143*^9, 3.761774802229864*^9}, 3.761776186523735*^9, {
   3.761777626294273*^9, 3.7617777254106913`*^9}, {3.761777776384572*^9, 
   3.7617778003812532`*^9}, {3.76177787991476*^9, 3.761777880398234*^9}, {
   3.761778060623127*^9, 3.7617780775803957`*^9}, {3.761778443904949*^9, 
   3.761778510222273*^9}, {3.761778642676834*^9, 3.7617786491316423`*^9}, 
   3.761779039517289*^9, {3.761779072611417*^9, 3.761779121027445*^9}, {
   3.76177916028019*^9, 3.761779192510015*^9}, {3.761779223183975*^9, 
   3.761779275166624*^9}, {3.7617793096619787`*^9, 3.7617793249969378`*^9}, {
   3.7617793728293867`*^9, 3.761779381908022*^9}, 3.761779513519744*^9, {
   3.7617799260574007`*^9, 3.761779967945853*^9}, 3.761780123003875*^9, {
   3.7617803734072866`*^9, 3.7617804025961246`*^9}, {3.761780505942275*^9, 
   3.761780523364588*^9}, 3.761781333926795*^9, {3.761781599685239*^9, 
   3.761781652280139*^9}, {3.7617817670360413`*^9, 3.76178179598525*^9}, {
   3.7617818275780783`*^9, 3.761781873339239*^9}, {3.7617820321049147`*^9, 
   3.761782037537322*^9}, {3.761782452091254*^9, 3.7617824615613337`*^9}, 
   3.761782534904065*^9, {3.7617826085718184`*^9, 3.761782613373665*^9}, {
   3.761782729468322*^9, 3.7617827327104588`*^9}, {3.761782784286778*^9, 
   3.761782800273999*^9}, {3.7617829288044357`*^9, 3.761782968057414*^9}, {
   3.76178300234359*^9, 3.7617831068346*^9}, {3.7617831848282433`*^9, 
   3.761783187776504*^9}, {3.761783225260891*^9, 3.7617832262108*^9}, {
   3.761783259200116*^9, 3.761783273370603*^9}, {3.7617833285702143`*^9, 
   3.7617834257844954`*^9}, {3.761783699857607*^9, 3.761783723360468*^9}, {
   3.761783758852582*^9, 3.761783835074733*^9}, {3.761783867816074*^9, 
   3.7617838686024513`*^9}, {3.7617839724718*^9, 3.7617840007392893`*^9}, {
   3.761784034150268*^9, 3.761784046787771*^9}, {3.761784219943877*^9, 
   3.761784237246663*^9}, {3.761784284211894*^9, 3.761784288255702*^9}, {
   3.761784515787499*^9, 3.7617845826360188`*^9}, 3.761784630866667*^9, {
   3.7617846635106153`*^9, 3.761784675149795*^9}, 3.761785740363093*^9, {
   3.761786019004236*^9, 3.761786071314839*^9}, {3.7617861367694263`*^9, 
   3.7617861479811573`*^9}, {3.761786203579462*^9, 3.761786217731736*^9}, {
   3.761786277916821*^9, 3.761786352744969*^9}, 3.761786401307418*^9, {
   3.761786612921831*^9, 3.761786645430024*^9}, {3.761786826246518*^9, 
   3.7617868437171164`*^9}, {3.761786901490595*^9, 3.761786929206045*^9}, {
   3.76178696107194*^9, 3.7617870291603403`*^9}, {3.761787073702793*^9, 
   3.761787074374198*^9}, {3.761787160801063*^9, 3.761787167188842*^9}, {
   3.76178731816389*^9, 3.761787335166576*^9}, {3.76178736681668*^9, 
   3.76178740657871*^9}, {3.761787779326016*^9, 3.7617878066302633`*^9}, {
   3.761787854916971*^9, 3.761787913516501*^9}, 3.761787959141193*^9, {
   3.761788204832109*^9, 3.761788426082862*^9}, {3.761788675862774*^9, 
   3.76178868727179*^9}, {3.761788830814159*^9, 3.76178883125108*^9}, {
   3.761788927980874*^9, 3.761788991034564*^9}, 3.7617890377005157`*^9, 
   3.761789091785412*^9, 3.761789153564851*^9, {3.7617892349696608`*^9, 
   3.761789273668717*^9}, {3.7617893317527018`*^9, 3.761789358037772*^9}, {
   3.761789425302307*^9, 3.761789456755958*^9}, {3.761789541802432*^9, 
   3.761789581856083*^9}, {3.761789657052162*^9, 3.761789667768704*^9}, {
   3.761789758722433*^9, 3.761789788686022*^9}, {3.7617898266189327`*^9, 
   3.761789831756626*^9}, 3.761789874498146*^9, {3.761827711106764*^9, 
   3.7618277451241083`*^9}, {3.76182791751619*^9, 3.761827918564747*^9}, {
   3.7618286572334623`*^9, 3.76182870515477*^9}, {3.761828885150814*^9, 
   3.7618289980836153`*^9}, {3.76182907434807*^9, 3.76182907579802*^9}, {
   3.761829275321311*^9, 3.7618293491695623`*^9}, {3.761829409296192*^9, 
   3.761829438754057*^9}, {3.761830010093384*^9, 3.7618300109102077`*^9}, {
   3.761830211479732*^9, 3.761830225903718*^9}, {3.76183029566438*^9, 
   3.761830327058194*^9}, {3.7618303599997053`*^9, 3.7618303741066227`*^9}, {
   3.761830428935363*^9, 3.761830451080024*^9}, {3.761830555169705*^9, 
   3.761830564766779*^9}, {3.7618306308888206`*^9, 3.7618306856589622`*^9}, 
   3.7618320521472397`*^9, {3.761832448455275*^9, 3.761832460470089*^9}, 
   3.7618324931354628`*^9, {3.7618325325683804`*^9, 3.761832602164081*^9}, 
   3.761832640707345*^9, {3.761832811255454*^9, 3.761832893214669*^9}, {
   3.761834213055213*^9, 3.761834213844706*^9}, {3.7618348532755747`*^9, 
   3.761834872084819*^9}, {3.761834920333737*^9, 3.761834934996971*^9}, {
   3.7618350716528683`*^9, 3.76183507713129*^9}, {3.761835117446999*^9, 
   3.7618352312113113`*^9}, {3.761835852153591*^9, 3.76183608610005*^9}, {
   3.761836546716723*^9, 3.761836719919491*^9}, 3.761837134935739*^9, {
   3.7618374173091908`*^9, 
   3.761837418140059*^9}},ExpressionUUID->"e9145504-b2d6-4a4a-86ac-\
9be47c370d8f"]
}, Closed]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Unprotect", "[", 
  RowBox[{"s1", ",", "s2"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{
   "s1", ",", "s2", ",", "r1", ",", "r2", ",", "r3", ",", "n1", ",", "n2", 
    ",", "p1", ",", "p2"}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"s1", "=", 
   RowBox[{"<|", 
    RowBox[{
     RowBox[{"\"\<origin\>\"", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"0.0", ",", "0"}], "}"}]}], ",", 
     RowBox[{"\"\<radius\>\"", "\[Rule]", "2"}], ",", 
     RowBox[{"\[Mu]", "\[Rule]", "1.5"}], ",", " ", 
     RowBox[{"\"\<type\>\"", "\[Rule]", "\"\<surface\>\""}]}], "|>"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"s2", "=", 
    RowBox[{"<|", 
     RowBox[{
      RowBox[{"\"\<origin\>\"", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"0.0", ",", "0.0"}], "}"}]}], ",", 
      RowBox[{"\"\<radius\>\"", "\[Rule]", "2"}], ",", 
      RowBox[{"\[Mu]", "\[Rule]", "1.5"}], ",", " ", 
      RowBox[{"\"\<type\>\"", "\[Rule]", "\"\<surface\>\""}]}], "|>"}]}], 
   ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Protect", "[", 
     RowBox[{"s1", ",", "s2"}], "]"}], ";"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"r1", "=", 
   RowBox[{"Ray", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "5.0"}], ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0.0", ",", "1"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"r1", ",", "r2", ",", "n1", ",", "p1"}], "}"}], "=", 
   RowBox[{"Refract", "[", 
    RowBox[{"r1", ",", "s1", ",", "\"\<Entering\>\""}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"r2", ",", "r3", ",", "n2", ",", "p2"}], "}"}], "=", 
   RowBox[{"Refract", "[", 
    RowBox[{"r2", ",", "s2", ",", "\"\<Leaving\>\""}], "]"}]}], 
  ";"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.761740533617415*^9, 3.7617405667563066`*^9}, {
   3.761741171529858*^9, 3.761741258798643*^9}, {3.761741313447947*^9, 
   3.761741318336631*^9}, {3.7617425224904737`*^9, 3.7617426288825073`*^9}, {
   3.7617430998968287`*^9, 3.7617431572306013`*^9}, {3.7617432940880404`*^9, 
   3.761743337466239*^9}, {3.761743747090407*^9, 3.761743753802293*^9}, {
   3.7617438608626842`*^9, 3.761743885689219*^9}, {3.761744475757473*^9, 
   3.761744521468121*^9}, {3.761744573623151*^9, 3.761744686243857*^9}, {
   3.7617449355437937`*^9, 3.76174495317735*^9}, {3.761744983658967*^9, 
   3.761745028007494*^9}, {3.761745063788664*^9, 3.76174515386285*^9}, {
   3.761745526529319*^9, 3.7617455273918533`*^9}, 3.761745687875403*^9, {
   3.7617459822166967`*^9, 3.761745982952552*^9}, {3.761746582812085*^9, 
   3.761746594289364*^9}, {3.7617467172727613`*^9, 3.761746727950005*^9}, {
   3.761746764410084*^9, 3.761746775054125*^9}, 3.7617468431103992`*^9, 
   3.761746890101022*^9, {3.761747088811811*^9, 3.761747089785535*^9}, {
   3.761747201483747*^9, 3.7617472066295643`*^9}, {3.761747256675597*^9, 
   3.7617472594242783`*^9}, {3.761747400987248*^9, 3.761747401140564*^9}, {
   3.7617480862859707`*^9, 3.761748090244733*^9}, {3.761748228593485*^9, 
   3.761748228654418*^9}, {3.7617483273995113`*^9, 3.7617483283865843`*^9}, {
   3.7617484213688803`*^9, 3.761748433096567*^9}, {3.76174871956092*^9, 
   3.761748731663186*^9}, {3.761749165439357*^9, 3.761749179144451*^9}, {
   3.761749225957493*^9, 3.7617492681281013`*^9}, {3.761751414141445*^9, 
   3.7617514408416452`*^9}, {3.7617514738297043`*^9, 3.761751481212426*^9}, {
   3.761751523811676*^9, 3.761751542381706*^9}, {3.761751605258897*^9, 
   3.761751696619445*^9}, {3.761751742477385*^9, 3.761751742607205*^9}, {
   3.7617518422079887`*^9, 3.761751881568077*^9}, {3.761752028842063*^9, 
   3.7617520633211203`*^9}, {3.761752120829966*^9, 3.761752121374982*^9}, {
   3.761752206544525*^9, 3.761752263261983*^9}, {3.7617522965711613`*^9, 
   3.761752387819284*^9}, {3.761752467277738*^9, 3.761752514626704*^9}, {
   3.761752700215967*^9, 3.761752816283668*^9}, {3.7617528716814213`*^9, 
   3.76175287204312*^9}, {3.761754179928666*^9, 3.7617541972316093`*^9}, {
   3.761776141771282*^9, 3.761776142447652*^9}, {3.761777961391159*^9, 
   3.7617779779311438`*^9}, {3.761779448704138*^9, 3.7617794583836308`*^9}, {
   3.761781346083954*^9, 3.761781346874901*^9}, {3.761781725353376*^9, 
   3.761781727356423*^9}, {3.761781918549818*^9, 3.761781922854185*^9}, {
   3.761784775582573*^9, 3.761784800688017*^9}, {3.761785034408708*^9, 
   3.761785035933724*^9}, {3.7617858212639627`*^9, 3.761785857928046*^9}, {
   3.761786514453251*^9, 3.761786514590898*^9}, {3.7617865628336687`*^9, 
   3.761786578466353*^9}, 3.7617870510888777`*^9, {3.7617872819266148`*^9, 
   3.761787287732637*^9}, {3.761829028128944*^9, 3.7618290373306723`*^9}, {
   3.761829116699977*^9, 3.761829173350421*^9}, 3.761829480050727*^9, {
   3.7618298036713333`*^9, 3.761829811324727*^9}, {3.761830717033485*^9, 
   3.761830727584152*^9}, {3.761830906257206*^9, 3.761830908270903*^9}, {
   3.76183257981287*^9, 3.761832585352808*^9}, 3.761832683856703*^9, {
   3.761832749263362*^9, 3.7618327722689466`*^9}, {3.761832917124226*^9, 
   3.761832924813878*^9}, {3.761833390882695*^9, 3.761833424032238*^9}, {
   3.7618334564777927`*^9, 3.761833537375832*^9}, {3.761834008178565*^9, 
   3.761834086454444*^9}, {3.761834139767975*^9, 3.7618341764712677`*^9}, {
   3.761834617646305*^9, 3.7618346395901937`*^9}, {3.7618352719048023`*^9, 
   3.7618353185286083`*^9}, {3.761835414627931*^9, 3.761835442372251*^9}, {
   3.761835580402687*^9, 3.761835674091524*^9}, {3.7618361051004257`*^9, 
   3.761836172223289*^9}, {3.761836737028268*^9, 3.76183675040207*^9}, {
   3.7618368386061*^9, 3.761836847718316*^9}, {3.761837176842724*^9, 
   3.761837233097444*^9}, {3.761837302894384*^9, 3.761837349425497*^9}, {
   3.761837449485106*^9, 
   3.7618374519942904`*^9}},ExpressionUUID->"8cd0792b-dbf6-40d6-bef1-\
590ebbff54e3"],

Cell[BoxData[
 RowBox[{"{", "}"}]], "Output",
 CellChangeTimes->{
  3.761837234537705*^9, {3.7618373061167707`*^9, 3.761837349985354*^9}, {
   3.76183742599443*^9, 
   3.761837452489861*^9}},ExpressionUUID->"76ce3228-cebc-4048-9022-\
5e56939460a2"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"plt1", "=", 
   RowBox[{"PlotRays2", "[", 
    RowBox[{"r1", ",", 
     RowBox[{"ScaleRay", "[", 
      RowBox[{"r2", ",", "0.1"}], "]"}], ",", "n1", ",", "p1"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"plt2", "=", 
   RowBox[{"PlotRays2", "[", 
    RowBox[{"r2", ",", 
     RowBox[{"ScaleRay", "[", 
      RowBox[{"r3", ",", "2"}], "]"}], ",", "n2", ",", "p2"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"lens", "=", 
   RowBox[{"PlotLens", "[", 
    RowBox[{"s1", ",", "s2"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Show", "[", 
  RowBox[{"lens", ",", "plt1", ",", "plt2"}], 
  "]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.761740533617415*^9, 3.7617405667563066`*^9}, {
   3.761741171529858*^9, 3.761741258798643*^9}, {3.761741313447947*^9, 
   3.761741318336631*^9}, {3.7617425224904737`*^9, 3.7617426288825073`*^9}, {
   3.7617430998968287`*^9, 3.7617431572306013`*^9}, {3.7617432940880404`*^9, 
   3.761743337466239*^9}, {3.761743747090407*^9, 3.761743753802293*^9}, {
   3.7617438608626842`*^9, 3.761743885689219*^9}, {3.761744475757473*^9, 
   3.761744521468121*^9}, {3.761744573623151*^9, 3.761744686243857*^9}, {
   3.7617449355437937`*^9, 3.76174495317735*^9}, {3.761744983658967*^9, 
   3.761745028007494*^9}, {3.761745063788664*^9, 3.76174515386285*^9}, {
   3.761745526529319*^9, 3.7617455273918533`*^9}, 3.761745687875403*^9, {
   3.7617459822166967`*^9, 3.761745982952552*^9}, {3.761746582812085*^9, 
   3.761746594289364*^9}, {3.7617467172727613`*^9, 3.761746727950005*^9}, {
   3.761746764410084*^9, 3.761746775054125*^9}, 3.7617468431103992`*^9, 
   3.761746890101022*^9, {3.761747088811811*^9, 3.761747089785535*^9}, {
   3.761747201483747*^9, 3.7617472066295643`*^9}, {3.761747256675597*^9, 
   3.7617472594242783`*^9}, {3.761747400987248*^9, 3.761747401140564*^9}, {
   3.7617480862859707`*^9, 3.761748090244733*^9}, {3.761748228593485*^9, 
   3.761748228654418*^9}, {3.7617483273995113`*^9, 3.7617483283865843`*^9}, {
   3.7617484213688803`*^9, 3.761748433096567*^9}, {3.76174871956092*^9, 
   3.761748731663186*^9}, {3.761749165439357*^9, 3.761749179144451*^9}, {
   3.761749225957493*^9, 3.7617492681281013`*^9}, {3.761751414141445*^9, 
   3.7617514408416452`*^9}, {3.7617514738297043`*^9, 3.761751481212426*^9}, {
   3.761751523811676*^9, 3.761751542381706*^9}, {3.761751605258897*^9, 
   3.761751696619445*^9}, {3.761751742477385*^9, 3.761751742607205*^9}, {
   3.7617518422079887`*^9, 3.761751881568077*^9}, {3.761752028842063*^9, 
   3.7617520633211203`*^9}, {3.761752120829966*^9, 3.761752121374982*^9}, {
   3.761752206544525*^9, 3.761752263261983*^9}, {3.7617522965711613`*^9, 
   3.761752387819284*^9}, {3.761752467277738*^9, 3.761752514626704*^9}, {
   3.761752700215967*^9, 3.761752816283668*^9}, {3.7617528716814213`*^9, 
   3.76175287204312*^9}, {3.761754179928666*^9, 3.7617541972316093`*^9}, {
   3.761776141771282*^9, 3.761776142447652*^9}, {3.761777961391159*^9, 
   3.7617779779311438`*^9}, {3.761779448704138*^9, 3.7617794583836308`*^9}, {
   3.761781346083954*^9, 3.761781346874901*^9}, {3.761781725353376*^9, 
   3.761781727356423*^9}, {3.761781918549818*^9, 3.761781922854185*^9}, {
   3.761784775582573*^9, 3.761784800688017*^9}, {3.761785034408708*^9, 
   3.761785035933724*^9}, {3.7617858212639627`*^9, 3.761785857928046*^9}, {
   3.761786514453251*^9, 3.761786514590898*^9}, {3.7617865628336687`*^9, 
   3.761786578466353*^9}, 3.7617870510888777`*^9, {3.7617872819266148`*^9, 
   3.761787287732637*^9}, {3.761829028128944*^9, 3.7618290373306723`*^9}, {
   3.761829116699977*^9, 3.761829173350421*^9}, 3.761829480050727*^9, {
   3.7618298036713333`*^9, 3.761829811324727*^9}, {3.761830717033485*^9, 
   3.761830727584152*^9}, {3.761830906257206*^9, 3.761830908270903*^9}, {
   3.76183257981287*^9, 3.761832585352808*^9}, 3.761832683856703*^9, {
   3.761832749263362*^9, 3.7618327722689466`*^9}, {3.761832917124226*^9, 
   3.761832924813878*^9}, {3.761833390882695*^9, 3.761833424032238*^9}, {
   3.7618334564777927`*^9, 3.761833537375832*^9}, {3.761834008178565*^9, 
   3.761834086454444*^9}, {3.761834139767975*^9, 3.7618341764712677`*^9}, {
   3.761834617646305*^9, 3.7618346395901937`*^9}, {3.7618352719048023`*^9, 
   3.7618353185286083`*^9}, {3.761835414627931*^9, 3.761835442372251*^9}, {
   3.761835580402687*^9, 3.761835674091524*^9}, {3.7618361051004257`*^9, 
   3.761836172223289*^9}, {3.761836737028268*^9, 3.76183675040207*^9}, {
   3.7618368386061*^9, 3.761836847718316*^9}, {3.761837176842724*^9, 
   3.76183722373507*^9}, {3.761837319984374*^9, 
   3.7618373228572187`*^9}},ExpressionUUID->"66beacda-d7a2-48f8-b950-\
bb8fdbb398aa"],

Cell[BoxData[
 GraphicsBox[{{DiskBox[{0., 0.}, 2], {}}, {
    PointBox[{-1.7320508075688772`, 1.}], 
    {RGBColor[1, 0, 0], LineBox[{{-5., 1}, {-1.7320508075688772`, 1.}}]}, 
    {RGBColor[0, 1, 0], 
     LineBox[{{-1.7320508075688772`, 1.}, {-1.361276727895606, 
      0.9310884330125857}}]}}, {
    PointBox[{1.9756899891638358`, 0.31088433012585676`}], 
    {RGBColor[1, 0, 0], 
     LineBox[{{-1.7320508075688772`, 1.}, {1.9756899891638358`, 
      0.31088433012585676`}}]}, 
    {RGBColor[0, 1, 0], 
     LineBox[{{1.9756899891638358`, 0.31088433012585676`}, {
      3.8421298748452473`, -0.40772693692856105`}}]}}},
  BaseStyle->{
    Hue[0.6, 0.3, 0.95]}]], "Output",
 CellChangeTimes->{
  3.761837199893815*^9, 3.7618372366059093`*^9, {3.761837307996251*^9, 
   3.761837351530573*^9}, {3.761837429343582*^9, 
   3.7618374538808117`*^9}},ExpressionUUID->"8216f881-8da3-4de2-9947-\
c667fb7a426e"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"plt1", "=", 
   RowBox[{"PlotRays2", "[", 
    RowBox[{"r1", ",", 
     RowBox[{"ScaleRay", "[", 
      RowBox[{"r2", ",", "0.1"}], "]"}], ",", "n1", ",", "p1", ",", 
     "\"\<True\>\""}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"plt2", "=", 
   RowBox[{"PlotRays2", "[", 
    RowBox[{"r2", ",", 
     RowBox[{"ScaleRay", "[", 
      RowBox[{"r3", ",", "2"}], "]"}], ",", "n2", ",", "p2", ",", 
     "\"\<True\>\""}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Show", "[", 
  RowBox[{"lens", ",", "plt1", ",", "plt2"}], 
  "]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.761740533617415*^9, 3.7617405667563066`*^9}, {
   3.761741171529858*^9, 3.761741258798643*^9}, {3.761741313447947*^9, 
   3.761741318336631*^9}, {3.7617425224904737`*^9, 3.7617426288825073`*^9}, {
   3.7617430998968287`*^9, 3.7617431572306013`*^9}, {3.7617432940880404`*^9, 
   3.761743337466239*^9}, {3.761743747090407*^9, 3.761743753802293*^9}, {
   3.7617438608626842`*^9, 3.761743885689219*^9}, {3.761744475757473*^9, 
   3.761744521468121*^9}, {3.761744573623151*^9, 3.761744686243857*^9}, {
   3.7617449355437937`*^9, 3.76174495317735*^9}, {3.761744983658967*^9, 
   3.761745028007494*^9}, {3.761745063788664*^9, 3.76174515386285*^9}, {
   3.761745526529319*^9, 3.7617455273918533`*^9}, 3.761745687875403*^9, {
   3.7617459822166967`*^9, 3.761745982952552*^9}, {3.761746582812085*^9, 
   3.761746594289364*^9}, {3.7617467172727613`*^9, 3.761746727950005*^9}, {
   3.761746764410084*^9, 3.761746775054125*^9}, 3.7617468431103992`*^9, 
   3.761746890101022*^9, {3.761747088811811*^9, 3.761747089785535*^9}, {
   3.761747201483747*^9, 3.7617472066295643`*^9}, {3.761747256675597*^9, 
   3.7617472594242783`*^9}, {3.761747400987248*^9, 3.761747401140564*^9}, {
   3.7617480862859707`*^9, 3.761748090244733*^9}, {3.761748228593485*^9, 
   3.761748228654418*^9}, {3.7617483273995113`*^9, 3.7617483283865843`*^9}, {
   3.7617484213688803`*^9, 3.761748433096567*^9}, {3.76174871956092*^9, 
   3.761748731663186*^9}, {3.761749165439357*^9, 3.761749179144451*^9}, {
   3.761749225957493*^9, 3.7617492681281013`*^9}, {3.761751414141445*^9, 
   3.7617514408416452`*^9}, {3.7617514738297043`*^9, 3.761751481212426*^9}, {
   3.761751523811676*^9, 3.761751542381706*^9}, {3.761751605258897*^9, 
   3.761751696619445*^9}, {3.761751742477385*^9, 3.761751742607205*^9}, {
   3.7617518422079887`*^9, 3.761751881568077*^9}, {3.761752028842063*^9, 
   3.7617520633211203`*^9}, {3.761752120829966*^9, 3.761752121374982*^9}, {
   3.761752206544525*^9, 3.761752263261983*^9}, {3.7617522965711613`*^9, 
   3.761752387819284*^9}, {3.761752467277738*^9, 3.761752514626704*^9}, {
   3.761752700215967*^9, 3.761752816283668*^9}, {3.7617528716814213`*^9, 
   3.76175287204312*^9}, {3.761754179928666*^9, 3.7617541972316093`*^9}, {
   3.761776141771282*^9, 3.761776142447652*^9}, {3.761777961391159*^9, 
   3.7617779779311438`*^9}, {3.761779448704138*^9, 3.7617794583836308`*^9}, {
   3.761781346083954*^9, 3.761781346874901*^9}, {3.761781725353376*^9, 
   3.761781727356423*^9}, {3.761781918549818*^9, 3.761781922854185*^9}, {
   3.761784775582573*^9, 3.761784800688017*^9}, {3.761785034408708*^9, 
   3.761785035933724*^9}, {3.7617858212639627`*^9, 3.761785857928046*^9}, {
   3.761786514453251*^9, 3.761786514590898*^9}, {3.7617865628336687`*^9, 
   3.761786578466353*^9}, 3.7617870510888777`*^9, {3.7617872819266148`*^9, 
   3.761787287732637*^9}, {3.761829028128944*^9, 3.7618290373306723`*^9}, {
   3.761829116699977*^9, 3.761829173350421*^9}, 3.761829480050727*^9, {
   3.7618298036713333`*^9, 3.761829811324727*^9}, {3.761830717033485*^9, 
   3.761830727584152*^9}, {3.761830906257206*^9, 3.761830908270903*^9}, {
   3.76183257981287*^9, 3.761832585352808*^9}, 3.761832683856703*^9, {
   3.761832749263362*^9, 3.7618327722689466`*^9}, {3.761832917124226*^9, 
   3.761832924813878*^9}, {3.761833390882695*^9, 3.761833424032238*^9}, {
   3.7618334564777927`*^9, 3.761833537375832*^9}, {3.761834008178565*^9, 
   3.761834086454444*^9}, {3.761834139767975*^9, 3.7618341764712677`*^9}, {
   3.761834617646305*^9, 3.7618346395901937`*^9}, {3.7618352719048023`*^9, 
   3.7618353185286083`*^9}, {3.761835414627931*^9, 3.761835442372251*^9}, {
   3.761835580402687*^9, 3.761835674091524*^9}, {3.7618361051004257`*^9, 
   3.761836172223289*^9}, {3.761836737028268*^9, 3.76183675040207*^9}, {
   3.7618368386061*^9, 3.761836847718316*^9}, {3.7618371658991547`*^9, 
   3.76183716877837*^9}, {3.7618372454776497`*^9, 3.761837253882162*^9}, {
   3.761837483533395*^9, 
   3.7618374842814903`*^9}},ExpressionUUID->"5f66b32a-cc18-480d-8dd0-\
99c586068680"],

Cell[BoxData[
 GraphicsBox[{{DiskBox[{0., 0.}, 2], {}}, {
    PointBox[{-1.7320508075688772`, 1.}], 
    {RGBColor[1, 0, 0], Dashing[{Small, Small}], 
     LineBox[{{-1.7320508075688772`, 1.}, {-0.7320508075688773, 1.}}]}, 
    {RGBColor[1, 0, 0], LineBox[{{-5., 1}, {-1.7320508075688772`, 1.}}]}, 
    {RGBColor[0, 1, 0], 
     LineBox[{{-1.7320508075688772`, 1.}, {-1.361276727895606, 
      0.9310884330125857}}]}, 
    {GrayLevel[0.5], 
     ArrowBox[{{-1.7320508075688772`, 1.}, {-2.598076211353316, 1.5}}]}, 
    {GrayLevel[0.5], Dashing[{Small, Small}], 
     LineBox[{{-1.7320508075688772`, 1.}, {-0.8660254037844386, 0.5}}]}}, {
    PointBox[{1.9756899891638358`, 0.31088433012585676`}], 
    {RGBColor[1, 0, 0], Dashing[{Small, Small}], 
     LineBox[{{1.9756899891638358`, 0.31088433012585676`}, {
      2.9588532367582285`, 0.12815494392963794`}}]}, 
    {RGBColor[1, 0, 0], 
     LineBox[{{-1.7320508075688772`, 1.}, {1.9756899891638358`, 
      0.31088433012585676`}}]}, 
    {RGBColor[0, 1, 0], 
     LineBox[{{1.9756899891638358`, 0.31088433012585676`}, {
      3.8421298748452473`, -0.40772693692856105`}}]}, 
    {GrayLevel[0.5], 
     ArrowBox[{{1.9756899891638358`, 0.31088433012585676`}, {
      0.9878449945819179, 0.15544216506292838`}}]}, 
    {GrayLevel[0.5], Dashing[{Small, Small}], 
     LineBox[{{1.9756899891638358`, 0.31088433012585676`}, {
      2.9635349837457534`, 0.4663264951887851}}]}}},
  BaseStyle->{
    Hue[0.6, 0.3, 0.95]},
  ImageSize->{833.05078125, Automatic}]], "Output",
 CellChangeTimes->{{3.7618340544375153`*^9, 3.7618340869470243`*^9}, {
   3.7618341401579313`*^9, 3.761834176836563*^9}, 3.761834226435569*^9, {
   3.761834618879541*^9, 3.761834640625181*^9}, 3.7618349655469007`*^9, 
   3.761835080898735*^9, 3.76183523718884*^9, {3.761835280628683*^9, 
   3.761835319178647*^9}, {3.761835421824101*^9, 3.761835442923291*^9}, {
   3.7618356005919456`*^9, 3.76183567537346*^9}, {3.761836107443183*^9, 
   3.761836172862858*^9}, {3.761836728024447*^9, 3.7618367513086243`*^9}, {
   3.761836823726616*^9, 3.761836848249383*^9}, 3.761837255329523*^9, 
   3.761837310605515*^9, 3.761837354841035*^9, {3.761837431740787*^9, 
   3.761837456453912*^9}},ExpressionUUID->"23199082-8ed3-45ed-9981-\
764c0480a96e"]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.7617528385552998`*^9, 3.7617529772762136`*^9}, {
   3.76175300855264*^9, 3.7617530184344597`*^9}, {3.76175339154816*^9, 
   3.761753452303718*^9}, {3.761753490049799*^9, 3.7617535407869883`*^9}, {
   3.761754657183516*^9, 3.7617546597988*^9}, {3.7617550501569567`*^9, 
   3.761755050433741*^9}, {3.7617551619958467`*^9, 3.761755268447792*^9}, {
   3.761755321416215*^9, 3.761755378616681*^9}, {3.76178522077978*^9, 
   3.76178528567163*^9}, {3.7617858944796886`*^9, 3.761785894876876*^9}, {
   3.761833008409087*^9, 3.761833143316586*^9}, {3.761833190363433*^9, 
   3.7618332303043623`*^9}, {3.7618332865849733`*^9, 3.761833288184636*^9}, 
   3.761833355963785*^9, {3.761833607565639*^9, 3.761833647107545*^9}, {
   3.76183388276788*^9, 3.761833936061764*^9}, {3.761834410466778*^9, 
   3.761834414517035*^9}, {3.7618344610705957`*^9, 3.761834461711666*^9}, {
   3.761834509289435*^9, 3.76183454657934*^9}, {3.76183536152413*^9, 
   3.761835389748303*^9}, {3.761835448545278*^9, 3.7618354490983057`*^9}, {
   3.7618354809182243`*^9, 3.76183551963818*^9}, 3.761835692271656*^9, {
   3.761836204702827*^9, 3.761836220741184*^9}, 3.7618363052268763`*^9, {
   3.761836515184897*^9, 3.761836537457869*^9}, {3.761836890970355*^9, 
   3.761836916568482*^9}, {3.761837022684389*^9, 3.761837024305423*^9}, {
   3.761837366650086*^9, 
   3.7618373929215317`*^9}},ExpressionUUID->"1904ae99-f282-492b-971e-\
1f3067a668da"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"s1", "=", 
   RowBox[{"<|", 
    RowBox[{
     RowBox[{"\"\<origin\>\"", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"0.0", ",", "0"}], "}"}]}], ",", 
     RowBox[{"\"\<radius\>\"", "\[Rule]", "1"}], ",", 
     RowBox[{"\[Mu]", "\[Rule]", "1.25"}], ",", " ", 
     RowBox[{"\"\<type\>\"", "\[Rule]", "\"\<surface\>\""}]}], "|>"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"s2", "=", 
   RowBox[{"<|", 
    RowBox[{
     RowBox[{"\"\<origin\>\"", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "1.5"}], ",", "0.0"}], "}"}]}], ",", 
     RowBox[{"\"\<radius\>\"", "\[Rule]", "1"}], ",", 
     RowBox[{"\[Mu]", "\[Rule]", "1.25"}], ",", " ", 
     RowBox[{"\"\<type\>\"", "\[Rule]", "\"\<surface\>\""}]}], "|>"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"lens", "=", 
   RowBox[{"PlotLens", "[", 
    RowBox[{"s1", ",", "s2"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Show", "[", 
  RowBox[{"lens", ",", "\[IndentingNewLine]", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"ShowPath", "[", 
       RowBox[{
        RowBox[{"-", "3."}], ",", "y", ",", "0", ",", "s1", ",", "s2", ",", 
        "0.1"}], "]"}], "[", 
      RowBox[{"[", "1", "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"y", ",", 
       RowBox[{"Range", "[", 
        RowBox[{
         RowBox[{"-", "0.4"}], ",", "0.4", ",", "0.1"}], "]"}]}], "}"}]}], 
    "]"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"ShowPath", "[", 
       RowBox[{
        RowBox[{"-", "3."}], ",", "y", ",", "0", ",", "s1", ",", "s2", ",", 
        "2"}], "]"}], "[", 
      RowBox[{"[", "2", "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"y", ",", 
       RowBox[{"Range", "[", 
        RowBox[{
         RowBox[{"-", "0.4"}], ",", "0.4", ",", "0.1"}], "]"}]}], "}"}]}], 
    "]"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}]}], "Input",
 CellChangeTimes->{{3.7618372866944027`*^9, 3.761837288108596*^9}, {
  3.761837489118361*^9, 
  3.7618374905146914`*^9}},ExpressionUUID->"a0058537-d5f5-4353-9eef-\
d64142002186"],

Cell[BoxData[
 GraphicsBox[{GraphicsComplexBox[CompressedData["
1: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
    "], 
    {Hue[0.6, 0.3, 0.95], Opacity[1], EdgeForm[Hue[0.6, 0.3, 0.75]], EdgeForm[
     None], 
     TagBox[PolygonBox[CompressedData["
1:eJwBFQXq+iFib1JiAgAAAKwBAAADAAAAIB9kNbS2oHaVHx5ugyJLfi5/mnrb
ZSODU1VuRwNJOxo8d5eYllyXPhs7PVEysV6arb1aPlQcUx4deV0GNkhiy03I
JCNl7dXkT2hpEA9oXEPumaJ4VliSQFdWKFspFj0XfWFGlWEqhjmEXCcmLSxg
nCthYH8tva3ASC8uYSsqSjAvxMfFGhkYN0g2Gxo7ura53eCnPD0yWHFyUT1w
cRQTFRRWdVl0ZhIR4IpQUx1UUXBsIUsiT4qJPhwbVxVWDWoObG1UTmZnS4DF
a4yNA0cESQMChojX383hMAIBSkkwRzc2N0pIxMXGXnl6k1l1e11fPTwXPjsy
XkRdXQcGoc/Ra1BqPBoYe3wIdAsKVpJAOzwyPBgXNbW0tbCxMEkCR0k3SEov
SUo3IIKATWWdgW+k3DNznchNlkNcZxEQczOshoeFhE5njGoNq2uNPRZXPjJR
QKxSbT9UHRxUUz+ObFQ+P1NUgY5vZFWBVhRxV0BScFdSFhVXchMSTpBydQoJ
paqeewgHWq6tJ1yidltClyYl7e7VeQYFRK9dBQR6Xnqarq+tlHxanJsss0Wy
W6AptrS3fkguYEViIYBLZGOCZB9uZEzGIyKDoZhlZ2YRcmZOaGcQToQ5Dw6L
Z2hPi2gPaYtqjA0MaWpQjQwLjVmeUWw+bFJtrG1Sj20zU24eZG5Vj2+OkZ/c
cFJsPVdwcnETVnFYZnISkE451nKQkXPWdXQKjXRZfAkIWZNBu3ZClUZhJSSY
z6FNW3jtmVsoenkFXXleBEd620c2XXsHfHtffF+udQl8RWB9m2Asfy4tYkh+
YGJ/fn9iIIAhxYBjgVWOTGSBgIJjIGSCOMlLx8g4T4dniYWH3d86hYiGh4aE
zTHmZ4eEh0+Jn5HYgaRMik9piTrhUIppOomKaosOaItpjYwMaoxrdI0LnllB
U45Vj44/bY8/M2+PkZA51nOSOdeRx8Ta1pJYrJJzdZSTwVq9fJR1lFrBKZUq
RpV2l1wmd9HQmJcllpd3JGWYoWVNJ5koeFuZszZitLWynCwrfWCbYX2cm5x9
ZYOdg0vJQaWenqqrb9ykkdfYdqBblSmgy9PPd5iheKJcmSeiqOul79DS3G8z
pJ/ZqKVB66mllMGT6efop6nda+NQvqhBqKbr3amjqqmnqaqlqqfjnquN46uq
rECSbawzsK2vujW2fK5ar65fXa9fsK9EsbBEwLA1XrFEsZqys7KaskW0NrOa
RbNifbdFt0a2sLU1sbK1dru5tka5Rbe0Rrd95Ly/v7q4drlGurm4u+S4ur3A
5LtCubu45ejDQZO+wrq/vsLDvsHCqL6m5L+4v7zCsMCtusA1wsG9wb6Twr26
w8K8w7zlvsOmTKTZxNnaS8U4xsVjZMZj2cZM7+k0xcc4nYPJzMcxOMjJncnI
ysvMzeLMzMvIy8rTx8zIzDHN5jGI4Trf7NTqltBDy89NztDRd9CWzuzQodF3
ztHP09Ts6+jn08rUz9POo97d56Pr1e7v1eXkctZYkdaQhtc514jY2ogx2dja
xMbZn9jZiNrYx9oxR9t6NprbkdxzpNyfo9Te4N061Mreyszi3d7f4t7KiuA6
4FDj5uHN4YWJzd/i3uLf42ur4OOn7eRC5dU05TTovOTliIXm4eaF6ufp5+qj
w+im6eg07zTV6unS7OrSo+rUo6nr6Oum0OzS0+zOW+1C7u14XO547+5D0O9D
6e/S2wmO/g==
       "]],
      Annotation[#, "Geometry"]& ], 
     {Opacity[0.], 
      PointBox[{1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18,
        19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 
       36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53,
        54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 
       71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88,
        89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 
       105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 
       119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 
       133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 
       147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 
       161, 162, 163, 164, 165, 166, 167, 168, 169, 170, 171, 172, 173, 174, 
       175, 176, 177, 178, 179, 180, 181, 182, 183, 184, 185, 186, 187, 188, 
       189, 190, 191, 192, 193, 194, 195, 196, 197, 198, 199, 200, 201, 202, 
       203, 204, 205, 206, 207, 208, 209, 210, 211, 212, 213, 214, 215, 216, 
       217, 218, 219, 220, 221, 222, 223, 224, 225, 226, 227, 228, 229, 230, 
       231, 232, 233, 234, 235, 236, 237, 238, 239}]}}], {
    PointBox[{-0.916515138991168, -0.4}], 
    {RGBColor[1, 0, 0], LineBox[{{-3., -0.4}, {-0.916515138991168, -0.4}}]}, 
    {RGBColor[0, 1, 0], 
     LineBox[{{-0.916515138991168, -0.4}, {-0.8168828869185654, \
-0.391431782744271}}]}}, {
    PointBox[{-0.9539392014169457, -0.30000000000000004`}], 
    {RGBColor[1, 0, 0], 
     LineBox[{{-3., -0.30000000000000004`}, {-0.9539392014169457, \
-0.30000000000000004`}}]}, 
    {RGBColor[0, 1, 0], 
     LineBox[{{-0.9539392014169457, -0.30000000000000004`}, \
{-0.8541333700670787, -0.2937713541951789}}]}}, {
    PointBox[{-0.9797958971132712, -0.2}], 
    {RGBColor[1, 0, 0], 
     LineBox[{{-3., -0.2}, {-0.9797958971132712, -0.2}}]}, 
    {RGBColor[0, 1, 0], 
     LineBox[{{-0.9797958971132712, -0.2}, {-0.8798785770511437, \
-0.19593439406700744`}}]}}, {
    PointBox[{-0.99498743710662, -0.09999999999999998}], 
    {RGBColor[1, 0, 0], 
     LineBox[{{-3., -0.09999999999999998}, {-0.99498743710662, \
-0.09999999999999998}}]}, 
    {RGBColor[0, 1, 0], 
     LineBox[{{-0.99498743710662, -0.09999999999999998}, \
{-0.8950076004461374, -0.09799195086135125}}]}}, {PointBox[{-1., 0.}], 
    {RGBColor[1, 0, 0], LineBox[{{-3., 0.}, {-1., 0.}}]}, 
    {RGBColor[0, 1, 0], LineBox[{{-1., 0.}, {-0.9, 0.}}]}}, {
    PointBox[{-0.99498743710662, 0.09999999999999998}], 
    {RGBColor[1, 0, 0], 
     LineBox[{{-3., 0.09999999999999998}, {-0.99498743710662, 
      0.09999999999999998}}]}, 
    {RGBColor[0, 1, 0], 
     LineBox[{{-0.99498743710662, 0.09999999999999998}, {-0.8950076004461374, 
      0.09799195086135125}}]}}, {
    PointBox[{-0.9797958971132712, 0.20000000000000007`}], 
    {RGBColor[1, 0, 0], 
     LineBox[{{-3., 0.20000000000000007`}, {-0.9797958971132712, 
      0.20000000000000007`}}]}, 
    {RGBColor[0, 1, 0], 
     LineBox[{{-0.9797958971132712, 
      0.20000000000000007`}, {-0.8798785770511437, 0.1959343940670075}}]}}, {
    PointBox[{-0.9539392014169457, 0.30000000000000004`}], 
    {RGBColor[1, 0, 0], 
     LineBox[{{-3., 0.30000000000000004`}, {-0.9539392014169457, 
      0.30000000000000004`}}]}, 
    {RGBColor[0, 1, 0], 
     LineBox[{{-0.9539392014169457, 
      0.30000000000000004`}, {-0.8541333700670787, 0.2937713541951789}}]}}, {
    PointBox[{-0.916515138991168, 0.4}], 
    {RGBColor[1, 0, 0], LineBox[{{-3., 0.4}, {-0.916515138991168, 0.4}}]}, 
    {RGBColor[0, 1, 0], 
     LineBox[{{-0.916515138991168, 0.4}, {-0.8168828869185654, 
      0.391431782744271}}]}}, {
    PointBox[{-0.5710852177487541, -0.3702935690977093}], 
    {RGBColor[1, 0, 0], 
     LineBox[{{-0.916515138991168, -0.4}, {-0.5710852177487541, \
-0.3702935690977093}}]}, 
    {RGBColor[0, 1, 0], 
     LineBox[{{-0.5710852177487541, -0.3702935690977093}, {1.382503981552587, 
      0.05806287170030955}}]}}, {
    PointBox[{-0.5382874493652043, -0.2740601575412148}], 
    {RGBColor[1, 0, 0], 
     LineBox[{{-0.9539392014169457, -0.30000000000000004`}, \
{-0.5382874493652043, -0.2740601575412148}}]}, 
    {RGBColor[0, 1, 0], 
     LineBox[{{-0.5382874493652043, -0.2740601575412148}, {1.438563390259609, 
      0.029355000080599547`}}]}}, {
    PointBox[{-0.516544603473181, -0.18115044311918538`}], 
    {RGBColor[1, 0, 0], 
     LineBox[{{-0.9797958971132712, -0.2}, {-0.516544603473181, \
-0.18115044311918538`}}]}, 
    {RGBColor[0, 1, 0], 
     LineBox[{{-0.516544603473181, -0.18115044311918538`}, {1.47391511063113, 
      0.013965231617066198`}}]}}, {
    PointBox[{-0.5040709109984453, -0.0901401668543675}], 
    {RGBColor[1, 0, 0], 
     LineBox[{{-0.99498743710662, -0.09999999999999998}, \
{-0.5040709109984453, -0.0901401668543675}}]}, 
    {RGBColor[0, 1, 0], 
     LineBox[{{-0.5040709109984453, -0.0901401668543675}, {
      1.4936421334035601`, 0.005476736599323531}}]}}, {PointBox[{-0.5, 0.}], 
    {RGBColor[1, 0, 0], LineBox[{{-1., 0.}, {-0.5, 0.}}]}, 
    {RGBColor[0, 1, 0], LineBox[{{-0.5, 0.}, {1.5, 0.}}]}}, {
    PointBox[{-0.5040709109984453, 0.0901401668543675}], 
    {RGBColor[1, 0, 0], 
     LineBox[{{-0.99498743710662, 0.09999999999999998}, {-0.5040709109984453, 
      0.0901401668543675}}]}, 
    {RGBColor[0, 1, 0], 
     LineBox[{{-0.5040709109984453, 0.0901401668543675}, {
      1.4936421334035601`, -0.005476736599323531}}]}}, {
    PointBox[{-0.5165446034731809, 0.18115044311918543`}], 
    {RGBColor[1, 0, 0], 
     LineBox[{{-0.9797958971132712, 
      0.20000000000000007`}, {-0.5165446034731809, 0.18115044311918543`}}]}, 
    {RGBColor[0, 1, 0], 
     LineBox[{{-0.5165446034731809, 0.18115044311918543`}, {
      1.4739151106311306`, -0.01396523161706617}}]}}, {
    PointBox[{-0.5382874493652042, 0.2740601575412148}], 
    {RGBColor[1, 0, 0], 
     LineBox[{{-0.9539392014169457, 
      0.30000000000000004`}, {-0.5382874493652042, 0.2740601575412148}}]}, 
    {RGBColor[0, 1, 0], 
     LineBox[{{-0.5382874493652042, 0.2740601575412148}, {
      1.4385633902596093`, -0.02935500008059938}}]}}, {
    PointBox[{-0.5710852177487541, 0.3702935690977093}], 
    {RGBColor[1, 0, 0], 
     LineBox[{{-0.916515138991168, 0.4}, {-0.5710852177487541, 
      0.3702935690977093}}]}, 
    {RGBColor[0, 1, 0], 
     LineBox[{{-0.5710852177487541, 0.3702935690977093}, {
      1.382503981552587, -0.05806287170030955}}]}}},
  BaseStyle->{
    Opacity[1], 
    EdgeForm[None]},
  ImageSize->{567.359375, Automatic}]], "Output",
 CellChangeTimes->{
  3.7618371048272257`*^9, 3.761837290550311*^9, {3.761837464952064*^9, 
   3.761837494163645*^9}},ExpressionUUID->"80327b9f-e711-42ff-87fd-\
144bb122c0b7"]
}, Open  ]],

Cell[CellGroupData[{

Cell["History ", "Text",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.},
 CellChangeTimes->{{3.7618320597938547`*^9, 3.7618320711957407`*^9}, {
  3.7618375020966177`*^9, 
  3.761837502952981*^9}},ExpressionUUID->"588e2a06-f4a6-4ada-9663-\
9bd3d7ac42fc"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"ClearAll", "[", "Refract", "]"}], "\[IndentingNewLine]", 
     RowBox[{"Refract", "[", 
      RowBox[{
       RowBox[{"ry_", "/;", 
        RowBox[{
         RowBox[{"ry", "[", "\"\<type\>\"", "]"}], "\[Equal]", 
         "\"\<ray\>\""}]}], ",", " ", 
       RowBox[{"s_", "/;", " ", 
        RowBox[{
         RowBox[{"s", "[", "\"\<type\>\"", "]"}], "\[Equal]", 
         "\"\<surface\>\""}]}], ",", 
       RowBox[{"motion_:", "\"\<Entering\>\""}]}], "]"}]}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        SubscriptBox["i", "p"], ",", 
        SubscriptBox["i", "r"], ",", "n", ",", 
        SubscriptBox["m", "i"], ",", 
        SubscriptBox["c", "p"], ",", 
        SubscriptBox["\[Theta]", "i"], ",", 
        SubscriptBox["\[Theta]", "r"], ",", 
        SubscriptBox["d", "r"], ",", "normal"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        SubscriptBox["i", "p"], "=", 
        RowBox[{"ry", "[", "\"\<pt2\>\"", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        SubscriptBox["c", "p"], "=", 
        RowBox[{"s", "[", "\"\<origin\>\"", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Echo", "[", 
        RowBox[{"{", 
         RowBox[{
          SubscriptBox["i", "p"], ",", 
          SubscriptBox["c", "p"]}], "}"}], "]"}], ";", "\[IndentingNewLine]", 
       
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"motion", "\[Equal]", "\"\<Entering\>\""}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"normal", "=", 
           RowBox[{"dir", "[", 
            RowBox[{"Ray", "[", 
             RowBox[{
              SubscriptBox["c", "p"], ",", 
              SubscriptBox["i", "p"]}], "]"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{
           SubscriptBox["\[Theta]", "i"], "=", 
           RowBox[{"RotAngle", "[", 
            RowBox[{
             RowBox[{"-", "normal"}], ",", 
             RowBox[{"dir", "[", "ry", "]"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{
           SubscriptBox["\[Theta]", "r"], "=", 
           RowBox[{"ArcSin", "[", 
            RowBox[{
             RowBox[{"Sin", "[", 
              SubscriptBox["\[Theta]", "i"], "]"}], "/", 
             RowBox[{"s", "[", "\[Mu]", "]"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"Echo", "[", 
           RowBox[{
            SubscriptBox["\[Theta]", "i"], ",", 
            "\"\<Entering, \!\(\*SubscriptBox[\(\[Theta]\), \(i\)]\)\>\""}], 
           "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"Echo", "[", 
           RowBox[{
            SubscriptBox["\[Theta]", "r"], ",", 
            "\"\<Entering,\!\(\*SubscriptBox[\(\[Theta]\), \(r\)]\)\>\""}], 
           "]"}], ";"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"normal", "=", 
           RowBox[{"dir", "[", 
            RowBox[{"Ray", "[", 
             RowBox[{
              SubscriptBox["i", "p"], ",", 
              SubscriptBox["c", "p"]}], "]"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{
           SubscriptBox["\[Theta]", "i"], "=", 
           RowBox[{"RotAngle", "[", 
            RowBox[{
             RowBox[{"-", "normal"}], ",", 
             RowBox[{"dir", "[", "ry", "]"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{
           SubscriptBox["\[Theta]", "r"], "=", 
           RowBox[{"ArcSin", "[", 
            RowBox[{
             RowBox[{"Sin", "[", 
              SubscriptBox["\[Theta]", "i"], "]"}], "*", 
             RowBox[{"s", "[", "\[Mu]", "]"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"Echo", "[", 
           RowBox[{
            SubscriptBox["\[Theta]", "i"], ",", 
            "\"\<Leaving, \!\(\*SubscriptBox[\(\[Theta]\), \(i\)]\)\>\""}], 
           "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"Echo", "[", 
           RowBox[{
            SubscriptBox["\[Theta]", "r"], ",", 
            "\"\<Leaving,\!\(\*SubscriptBox[\(\[Theta]\), \(r\)]\)\>\""}], 
           "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Abs", "[", 
              SubscriptBox["\[Theta]", "r"], "]"}], "\[GreaterEqual]", " ", 
             RowBox[{"\[Pi]", "/", "2"}]}], ",", 
            RowBox[{
            "Echo", "[", 
             "\"\<\!\(\*SubscriptBox[\(\[Theta]\), \(r\)]\)>=\[Pi]/2\>\"", 
             "]"}], ",", "Continue"}], "]"}]}]}], "\[IndentingNewLine]", 
        "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"Echo", "[", 
        RowBox[{
         SubscriptBox["\[Theta]", "i"], 
         SubscriptBox["\[Theta]", "r"]}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{
        SubscriptBox["d", "r"], "=", 
        RowBox[{
         RowBox[{"RotationMatrix", "[", 
          SubscriptBox["\[Theta]", "r"], "]"}], ".", 
         RowBox[{"(", 
          RowBox[{"-", "normal"}], ")"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         SubscriptBox["i", "r"], "=", 
         RowBox[{"Ray", "[", 
          RowBox[{
           SubscriptBox["i", "p"], ",", 
           RowBox[{
            SubscriptBox["i", "p"], "+", 
            RowBox[{"3", 
             SubscriptBox["d", "r"]}]}]}], "]"}]}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"Ray", "[", 
        RowBox[{
         SubscriptBox["i", "p"], ",", 
         RowBox[{
          SubscriptBox["i", "p"], "+", 
          RowBox[{"3", 
           SubscriptBox["d", "r"]}]}]}], "]"}]}]}], "\[IndentingNewLine]", 
     "]"}]}], "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     UnderscriptBox[
      UnderscriptBox["\[CapitalIota]", "_"], "_"], "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", "0", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "1", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "}"}]}], ";"}], "*)"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"motion", "=", 
     RowBox[{
      RowBox[{"\"\<Leaving\>\"", "\[IndentingNewLine]", "s"}], "=", "s2"}]}], 
    ";", "\[IndentingNewLine]", 
    RowBox[{
     SubscriptBox["n", "1"], "=", "1.2"}], ";", "\[LineSeparator]", 
    "\[LineSeparator]", "\[IndentingNewLine]", 
    RowBox[{
     SubscriptBox["n", "2"], "=", "1"}], ";", "\[IndentingNewLine]", 
    RowBox[{"p", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"Intersect", "[", 
        RowBox[{"r2", ",", "s", ",", "motion"}], "]"}], "\[IndentingNewLine]", 
       RowBox[{"r2", "[", "\"\<pt2\>\"", "]"}]}], "=", "p"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"n", "=", 
     RowBox[{"ComputeNormal", "[", 
      RowBox[{"s", ",", "p", ",", "motion"}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"r3", "=", 
     RowBox[{"Ray", "[", 
      RowBox[{"p", ",", 
       RowBox[{"p", "+", 
        RowBox[{"RefractDirection", "[", 
         RowBox[{"n", ",", 
          RowBox[{"dir", "[", "r2", "]"}], ",", 
          SubscriptBox["n", "1"], ",", 
          SubscriptBox["n", "2"]}], "]"}]}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "*)"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"ClearAll", "[", "RotAngle", "]"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"RotAngle", "[", 
      RowBox[{
       RowBox[{"u_", "/;", 
        RowBox[{"VectorQ", "[", "u", "]"}]}], ",", 
       RowBox[{"v_", "/;", 
        RowBox[{"VectorQ", "[", "v", "]"}]}]}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"\[Theta]", ",", 
         RowBox[{"u1", "=", 
          RowBox[{"u", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], ",", 
         RowBox[{"u2", "=", 
          RowBox[{"u", "[", 
           RowBox[{"[", "2", "]"}], "]"}]}], ",", 
         RowBox[{"v1", "=", 
          RowBox[{"v", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], ",", 
         RowBox[{"v2", "=", 
          RowBox[{"v", "[", 
           RowBox[{"[", "2", "]"}], "]"}]}], ",", "x"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"x", "=", 
          RowBox[{"\[Theta]", "/.", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"FindRoot", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{"u1", " ", 
                    RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "-", 
                   RowBox[{"u2", " ", 
                    RowBox[{"Sin", "[", "\[Theta]", "]"}]}]}], "\[Equal]", 
                  "v1"}], ","}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"\[Theta]", ",", "0.0001"}], "}"}]}], "]"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"FindRoot", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{
                  RowBox[{"u2", " ", 
                   RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "+", 
                  RowBox[{"u1", " ", 
                   RowBox[{"Sin", "[", "\[Theta]", "]"}]}]}], "\[Equal]", 
                 "v2"}], " ", "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"\[Theta]", ",", "0.0001"}], "}"}]}], "]"}]}], 
            "}"}]}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Abs", "[", 
             RowBox[{"x", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "]"}], "<", 
            RowBox[{"Abs", "[", 
             RowBox[{"x", "[", 
              RowBox[{"[", "2", "]"}], "]"}], "]"}]}], ",", 
           RowBox[{"x", "[", 
            RowBox[{"[", "1", "]"}], "]"}], ",", 
           RowBox[{"x", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], "\[IndentingNewLine]", 
        "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"\[Theta]", ",", "r"}], "}"}], "/.", 
        RowBox[{
         RowBox[{"NSolve", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"u1", " ", 
                RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "-", 
               RowBox[{"u2", " ", 
                RowBox[{"Sin", "[", "\[Theta]", "]"}]}]}], "\[Equal]", " ", 
              RowBox[{"r", " ", "v1"}]}], ",", "\[IndentingNewLine]", "  ", 
             RowBox[{
              RowBox[{
               RowBox[{"u2", " ", 
                RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "+", 
               RowBox[{"u1", " ", 
                RowBox[{"Sin", "[", "\[Theta]", "]"}]}]}], "\[Equal]", 
              RowBox[{"r", " ", "v2"}]}]}], " ", "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"\[Theta]", ",", "r"}], "}"}]}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
    "\[IndentingNewLine]", "*)"}], 
   RowBox[{
    RowBox[{"RotAngle", "[", 
     RowBox[{
      RowBox[{"u_", "/;", 
       RowBox[{"VectorQ", "[", "u", "]"}]}], ",", 
      RowBox[{"v_", "/;", 
       RowBox[{"VectorQ", "[", "v", "]"}]}]}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"Cross", "[", 
         RowBox[{
          RowBox[{"Flatten", "[", 
           RowBox[{"{", 
            RowBox[{"u", ",", "0"}], "}"}], "]"}], ",", 
          RowBox[{"Flatten", "[", 
           RowBox[{"{", 
            RowBox[{"v", ",", "0.0"}], "}"}], "]"}]}], "]"}], "[", 
        RowBox[{"[", "3", "]"}], "]"}], 
       RowBox[{"ArcCos", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"u", "/", 
           RowBox[{"Norm", "[", "u", "]"}]}], ")"}], ".", 
         RowBox[{"(", 
          RowBox[{"v", "/", 
           RowBox[{"Norm", "[", "v", "]"}]}], ")"}]}], "]"}]}]}], "]"}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Intersect", "[", 
      RowBox[{
       RowBox[{"ry_", "/;", 
        RowBox[{
         RowBox[{"ry", "[", "\"\<type\>\"", "]"}], "\[Equal]", 
         "\"\<ray\>\""}]}], ",", " ", 
       RowBox[{"s_", "/;", " ", 
        RowBox[{
         RowBox[{"s", "[", "\"\<type\>\"", "]"}], "\[Equal]", 
         "\"\<surface\>\""}]}]}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "m", ",", "c", ",", "x1", ",", "y1", ",", "x2", ",", "y2", ",", "ox", 
         ",", "oy", ",", "r", ",", "x", ",", "y", ",", "sol"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"ox", ",", "oy"}], "}"}], "=", 
         RowBox[{"s", "[", "\"\<origin\>\"", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"r", "=", 
         RowBox[{"s", "[", "\"\<radius\>\"", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"m", ",", "c"}], "}"}], "=", 
         RowBox[{"Computemc", "[", "ry", "]"}]}], ";", "\[IndentingNewLine]", 
        
        RowBox[{"sol", "=", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"x", ",", "y"}], "}"}], "/.", 
          RowBox[{"NSolve", "[", " ", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"x", "-", "ox"}], ")"}], "2"], "+", " ", 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"y", "-", "oy"}], ")"}], "2"]}], "\[Equal]", 
              SuperscriptBox["r", "2"]}], " ", "&&", " ", 
             RowBox[{
              RowBox[{"yl", "[", 
               RowBox[{"x", ",", "m", ",", "c"}], "]"}], "\[Equal]", "y"}]}], 
            ",", " ", 
            RowBox[{"{", 
             RowBox[{"x", ",", "y"}], "}"}]}], " ", "]"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"sol", "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", "1"}], "]"}], "]"}], "<", 
           RowBox[{"sol", "[", 
            RowBox[{"[", 
             RowBox[{"2", ",", "1"}], "]"}], "]"}]}], ",", 
          RowBox[{"sol", "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", 
          RowBox[{"sol", "[", 
           RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}]}], "\[IndentingNewLine]",
       "]"}]}], "\[IndentingNewLine]", "*)"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"motion", "=", 
      RowBox[{
       RowBox[{"\"\<Entering\>\"", "\[IndentingNewLine]", "s"}], "=", 
       "s1"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      SubscriptBox["n", "1"], "=", "1"}], ";", "\[IndentingNewLine]", 
     RowBox[{
      SubscriptBox["n", "2"], "=", "1.2"}], ";", "\[IndentingNewLine]", 
     RowBox[{"p", "=", 
      RowBox[{"Intersect", "[", 
       RowBox[{"r1", ",", "s", ",", "motion"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"r1", "[", "\"\<pt2\>\"", "]"}], "=", "p"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"n", "=", 
      RowBox[{"ComputeNormal", "[", 
       RowBox[{"s", ",", "p", ",", "motion"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"r2", "=", 
      RowBox[{"Ray", "[", 
       RowBox[{"p", ",", 
        RowBox[{"p", "+", 
         RowBox[{"RefractDirection", "[", 
          RowBox[{"n", ",", 
           RowBox[{"dir", "[", "r1", "]"}], ",", 
           SubscriptBox["n", "1"], ",", 
           SubscriptBox["n", "2"]}], "]"}]}]}], "]"}]}], ";"}], 
    "\[IndentingNewLine]", "*)"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   "\[IndentingNewLine]"}]}]], "Input",
 Evaluatable->False,
 CellGroupingRules->{"GroupTogetherGrouping", 10000.},
 CellChangeTimes->{
  3.7618320711978827`*^9, {3.761832440060547*^9, 
   3.7618325113057337`*^9}},ExpressionUUID->"3ed2cd1c-1da2-4c8d-8a63-\
11ce5d1378ac"]
}, Closed]]
}, Open  ]]
},
WindowSize->{1255, 1001},
WindowMargins->{{13, Automatic}, {Automatic, 0}},
FrontEndVersion->"11.3 for Mac OS X x86 (32-bit, 64-bit Kernel) (March 5, \
2018)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 239, 4, 98, "Title",ExpressionUUID->"1558d90f-ff46-45d0-9a19-705206b84cfc"],
Cell[822, 28, 283, 6, 35, "Text",ExpressionUUID->"3a51ea9d-8b2f-44b9-92c1-1491937d33e5"],
Cell[CellGroupData[{
Cell[1130, 38, 213, 4, 54, "Subsection",ExpressionUUID->"94f4e1c6-b805-4e8c-96b7-bfda568c21df",
 CellGroupingRules->{"GroupTogetherGrouping", 10001.}],
Cell[1346, 44, 1276, 25, 153, "Input",ExpressionUUID->"dd9b7a16-d3bf-486f-a1d5-a7b371677baf",
 CellGroupingRules->{"GroupTogetherGrouping", 10001.}]
}, Closed]],
Cell[CellGroupData[{
Cell[2659, 74, 213, 4, 38, "Subsection",ExpressionUUID->"a24b34c4-1026-4560-a854-0a7a9d6d6c3a",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.}],
Cell[2875, 80, 34233, 802, 3005, "Input",ExpressionUUID->"e9145504-b2d6-4a4a-86ac-9be47c370d8f",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.}]
}, Closed]],
Cell[CellGroupData[{
Cell[37145, 887, 6010, 114, 195, "Input",ExpressionUUID->"8cd0792b-dbf6-40d6-bef1-590ebbff54e3"],
Cell[43158, 1003, 248, 6, 34, "Output",ExpressionUUID->"76ce3228-cebc-4048-9022-5e56939460a2"]
}, Open  ]],
Cell[CellGroupData[{
Cell[43443, 1014, 4705, 76, 115, "Input",ExpressionUUID->"66beacda-d7a2-48f8-b950-bb8fdbb398aa"],
Cell[48151, 1092, 903, 20, 188, "Output",ExpressionUUID->"8216f881-8da3-4de2-9947-c667fb7a426e"]
}, Open  ]],
Cell[CellGroupData[{
Cell[49091, 1117, 4673, 73, 94, "Input",ExpressionUUID->"5f66b32a-cc18-480d-8dd0-99c586068680"],
Cell[53767, 1192, 2254, 42, 411, "Output",ExpressionUUID->"23199082-8ed3-45ed-9981-764c0480a96e"]
}, Open  ]],
Cell[56036, 1237, 1459, 21, 32, "Input",ExpressionUUID->"586a2d46-225e-478b-acf8-54d457182f28"],
Cell[CellGroupData[{
Cell[57520, 1262, 2158, 61, 180, "Input",ExpressionUUID->"a0058537-d5f5-4353-9eef-d64142002186"],
Cell[59681, 1325, 13360, 248, 197, "Output",ExpressionUUID->"80327b9f-e711-42ff-87fd-144bb122c0b7"]
}, Open  ]],
Cell[CellGroupData[{
Cell[73078, 1578, 260, 5, 30, "Text",ExpressionUUID->"15b7c703-4414-45d7-9cdc-466ef15fcc63",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.}],
Cell[73341, 1585, 16694, 443, 1851, "Input",ExpressionUUID->"cf64c50d-5d17-408c-822c-fadd786cbc54",
 Evaluatable->False,
 CellGroupingRules->{"GroupTogetherGrouping", 10000.}]
}, Closed]]
}, Open  ]]
}
]
*)

